#include <stdio.h>
#include <string.h>
#include <stdint.h>

void test_ld_lasx(int*);
void test_ldx_lasx(int*);
void test_xor_lasx(int*);
void test_ilvl_lasx(int*);
void test_ilvh_lasx(int*);
void test_transpose4x4_w_lasx(int*);
void test_transpose4x4_h_lasx(int16_t*);
void test_transpose8x8_h_lasx(int16_t*);
void test_transpose8x8_w_lasx(int*);
void test_transpose4x4_d_lasx(int64_t*);

void test_ld_c() {
    int ref[64] = {
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f
    };
    int dst[64];
    test_ld_lasx(dst);
    if (!memcmp(dst, ref, 64 * 4))
    {
        printf("Macro LD utest passed !!! \n");
        return;
    }
    printf("Macro LD utest failed !!! \n");
}

void test_ldx_c() {
    int ref[64] = {
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f
    };
    int dst[64];
    test_ldx_lasx(dst);
    if (!memcmp(dst, ref, 64 * 4))
    {
        printf("Macro LDX utest passed !!! \n");
        return;
    }
    printf("Macro LDX utest failed !!! \n");
}

void test_xor_c() {
    int ref[48] = {
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0x10^0x14, 0x11^0x15, 0x12^0x16, 0x13^0x17,
    0x18^0x1c, 0x19^0x1d, 0x1a^0x1e, 0x1b^0x1f,
    0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0,
    0x10^0x18, 0x11^0x19, 0x12^0x1a, 0x13^0x1b,
    0x14^0x1c, 0x15^0x1d, 0x16^0x1e, 0x17^0x1f
    };
    int dst[48];
    test_xor_lasx(dst);
    if (!memcmp(dst, ref, 48 * 4))
    {
        printf("Macro XOR utest passed !!! \n");
        return;
    }
    printf("Macro XOR utest failed !!! \n");
}

void test_ilvl_c() {
    int ref[48] = {
    0, 0, 1, 1, 4, 4, 5, 5,
    8, 8, 9, 9, 0xc, 0xc, 0xd, 0xd,
    0x10, 0x14, 0x11, 0x15, 0x18, 0x1c, 0x19, 0x1d,
    0, 0, 1, 1, 4, 4, 5, 5,
    8, 8, 9, 9, 0xc, 0xc, 0xd, 0xd,
    0x10, 0x18, 0x11, 0x19, 0x14, 0x1c, 0x15, 0x1d
    };
    int dst[48];
    test_ilvl_lasx(dst);
    if (!memcmp(dst, ref, 48 * 4))
    {
        printf("Macro ILVL utest passed !!! \n");
        return;
    }
    printf("Macro ILVL utest failed !!! \n");
}

void test_ilvh_c() {
    int ref[48] = {
    2, 2, 3, 3, 6, 6, 7, 7,
    0xa, 0xa, 0xb, 0xb, 0xe, 0xe, 0xf, 0xf,
    0x12, 0x16, 0x13, 0x17, 0x1a, 0x1e, 0x1b, 0x1f,
    2, 2, 3, 3, 6, 6, 7, 7,
    0xa, 0xa, 0xb, 0xb, 0xe, 0xe, 0xf, 0xf,
    0x12, 0x1a, 0x13, 0x1b, 0x16, 0x1e, 0x17, 0x1f
    };
    int dst[48];
    test_ilvh_lasx(dst);
    if (!memcmp(dst, ref, 48 * 4))
    {
        printf("Macro ILVH utest passed !!! \n");
        return;
    }
    printf("Macro ILVH utest failed !!! \n");
}

void test_transpose4x4_h_c() {
    int16_t ref[32] = {
        0, 8, 0x10, 0x18, 1, 9, 0x11, 0x19,
        2, 0xa, 0x12, 0x1a, 3, 0xb, 0x13, 0x1b,
        0, 8, 0x10, 0x18, 1, 9, 0x11, 0x19,
        2, 0xa, 0x12, 0x1a, 3, 0xb, 0x13, 0x1b
    };
    int16_t dst[32];
    test_transpose4x4_h_lasx(dst);
    if (!memcmp(dst, ref, 32 * 2))
    {
        printf("Macro TRANSPOSE4x4_H utest passed !!! \n");
        return;
    }
    printf("Macro TRANSPOSE4x4_H utest failed !!! \n");
}

void test_transpose8x8_h_c() {
    int16_t ref[64] = {
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f
    };
    int16_t dst[64];
    test_transpose8x8_h_lasx(dst);
    if (!memcmp(dst, ref, 64 * 2))
    {
        printf("Macro TRANSPOSE8x8_H utest passed !!! \n");
        return;
    }
    printf("Macro TRANSPOSE8x8_H utest failed !!! \n");
}

void test_transpose4x4_w_c() {
    int ref[32] = {
        0, 4, 8, 0xc, 1, 5, 9, 0xd,
        2, 6, 0xa, 0xe, 3, 7, 0xb, 0xf,
        0x10, 0x18, 0, 8, 0x11, 0x19, 1, 9,
        0x12, 0x1a, 2, 0xa, 0x13, 0x1b, 3, 0xb
    };
    int dst[32];
    test_transpose4x4_w_lasx(dst);
    if (!memcmp(dst, ref, 32 * 4))
    {
        printf("Macro TRANSPOSE4x4_W utest passed !!! \n");
        return;
    }
    printf("Macro TRANSPOSE4x4_W utest failed !!! \n");
}

void test_transpose8x8_w_c() {
    int ref[64] = {
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,
    0, 1,   2,   3,   4,   5,   6,   7,
    8, 9, 0xa, 0xb, 0xc, 0xd, 0xe, 0xf,
    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17,
    0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f
    };
    int dst[64];
    test_transpose8x8_w_lasx(dst);
    if (!memcmp(dst, ref, 64 * 4))
    {
        printf("Macro TRANSPOSE8x8_W utest passed !!! \n");
        return;
    }
    printf("Macro TRANSPOSE8x8_W utest failed !!! \n");
}

void test_transpose4x4_d_c() {
    int64_t ref[16] = {
    0, 1, 2, 3,
    4, 5, 6, 7,
    8, 9, 0xa, 0xb,
    0xc, 0xd, 0xe, 0xf
    };
    int64_t dst[16];
    test_transpose4x4_d_lasx(dst);
    if (!memcmp(dst, ref, 16 * 8))
    {
        printf("Macro TRANSPOSE4x4_D utest passed !!! \n");
        return;
    }
    printf("Macro TRANSPOSE4x4_D utest failed !!! \n");
}

void main() {
    test_ld_c();
    test_ldx_c();
    test_xor_c();
    test_ilvl_c();
    test_ilvh_c();
    test_transpose4x4_h_c();
    test_transpose8x8_h_c();
    test_transpose4x4_w_c();
    test_transpose8x8_w_c();
    test_transpose4x4_d_c();
}
